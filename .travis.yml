language: php

dist: trusty
sudo: false

services:
  - mysql

php:
  - 7.1

before_script:
  - npm install csslint eslint eslint-config-strict eslint-plugin-filenames
  - composer install
  - echo "USE mysql;\nUPDATE user SET password=PASSWORD('tablutpw') WHERE user='root';\nFLUSH PRIVILEGES;\n" | mysql -u root

script:
  - composer check-styles
  - composer test

  - node_modules/.bin/eslint tablut.js
  - node_modules/.bin/csslint tablut.css

  - cp bgaproject.yml.dist bgaproject.yml
  - composer bgaw-clean
  - composer bgaw-build
  - composer bgaw-validate
